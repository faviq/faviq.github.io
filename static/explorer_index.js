(function() {

  var allData = [{"id": 'a_set_test', "claim": "Wonder woman was not wearing a sword and shield when she was first introduced.", "label": "REFUTES", "positive_evidence": {"id": "23954391", "title": "Wonder Woman", "text": "Wonder Woman's outfit has varied over time, although almost all of her outfit incarnations have retained some form of chestplate, subligaculum, tiara, bracelets, and her signature five-pointed star symbols. When Wonder Woman was first introduced, she wore a heavily patriotic skirt and red top which incorporated an American eagle and elements of the United States flag, reflecting the comic's origins during World War II. Later artists introduced what would become Wonder Woman's classic ensemble, adding an armored plate to her top whose design recalls a letter W and revealing blue short shorts, whose precise length varied from artist to artist. Other artists have experimented with different looks for Wonder Woman over the years, including an all-white mod jumpsuit, a biker outfit, a variation of her mainstream depiction featuring leather pants and a jacket, and a number of armoured battlesuits. Contemporary artists have attempted to emphasise Wonder Woman's traditional outfit as a red armored top with a blue gladiator skirt."}, "negative_evidence": {"id": "18702506", "title": "Alternative versions of Wonder Woman", "text": "BULLET::::- In the alternative timeline shown in the \"Flashpoint\" miniseries, Wonder Woman wages a war against Aquaman and the Atlanteans. As a young girl, Diana met and befriended a young Arthur Curry. When they reach adulthood, they agree to a Marriage of convenience, wherein they will reveal their societies to the world at large together. On the day of their wedding, Hippolyta was killed by a spear thrown by an Atlantean. Unbeknownst to the bride or groom, Hippolyta's death was part of a scheme concocted by Ocean Master, Artemis and Wonder Woman's aunt, Penthesileia, to prevent the union of Aquaman and Wonder Woman (Diana was the intended target, but Hippolyta got in the way). In retaliation, Wonder Woman declares war on Atlantis. Aquaman and the Atlanteans then visit Themyscira to negotiate for peace, but Artemis has bombs dropped on Themyscira, with Wonder Woman angrily believing the Atlanteans were behind it. Wonder Woman's only option is to destroy Themyscira and then escape on the Amazon's invisible planes. She then leads the Amazons in conquering the United Kingdom, renaming it New Themyscira. Wonder Woman later catches Steve Trevor with her Lasso of Truth and begins interrogating him after he is temporarily able to resist the lasso's effects. Steve explains that he was hired to extract Lois Lane from New Themyscira because she was sent to gather information on the Amazons for Cyborg. Wonder Woman states that their counterspy was telling something similar to Cyborg's amassing of superhumans to stop the fighting between her and Aquaman. Her subjects ask her what to do with Steve. Later, Wonder Woman attacks the Resistance member Penny Black, but Penny shows her that people were imprisoned of internment by her aunt Penthesileia. Wonder Woman is furious and frees the people from internment, which she believes that they are not accepted for prison. During this same period, the Amazonian Furies attack the reinforcements of a group of Atlanteans sent to kill Terra, who was being used to keep New Themyscira in the air; Wonder Woman personally joins the battle, confronting the leader, Aquaman. During their struggle, she tells Aquaman that they have both been deceived, when she discovers that her aunt Penthesileia kissing Ocean Master are both responsible for the war between the Atlanteans and the Amazons, that was a ruse planned by them. While the Atlanteans are going to surface, but their attack having been backfired by Ocean Master, Aquaman believes Wonder Woman has set a trap. Wonder Woman escapes from Aquaman, who refuses her word. Wonder Woman then contacts the Amazons to defend their home. The battlefield of Wonder Woman and Aquaman are them fighting; however, they are both approached by the Flash and the heroes that are here to stop the war. Wonder Woman is struggled by Kal-El, who intends to attack her at the last battle."}, "div": "a_set"}, {"id": 20, "claim": "Wonder woman got a sword and shield when she was first introduced.", "label": "REFUTES", "positive_evidence": {"id": "2", "title": "Wonder Woman", "text": "Wonder Woman's outfit has varied over time, although almost all of her outfit incarnations have retained some form of chestplate, subligaculum, tiara, bracelets, and her signature five-pointed star symbols. When Wonder Woman was first introduced, she wore a heavily patriotic skirt and red top which incorporated an American eagle and elements of the United States flag, reflecting the comic's origins during World War II. Later artists introduced what would become Wonder Woman's classic ensemble, adding an armored plate to her top whose design recalls a letter W and revealing blue short shorts, whose precise length varied from artist to artist. Other artists have experimented with different looks for Wonder Woman over the years, including an all-white mod jumpsuit, a biker outfit, a variation of her mainstream depiction featuring leather pants and a jacket, and a number of armoured battlesuits. Contemporary artists have attempted to emphasise Wonder Woman's traditional outfit as a red armored top with a blue gladiator skirt."}, "negative_evidence": {"id": "18702506", "title": "Alternative versions of Wonder Woman", "text": "BULLET::::- In the alternative timeline shown in the \"Flashpoint\" miniseries, Wonder Woman wages a war against Aquaman and the Atlanteans. As a young girl, Diana met and befriended a young Arthur Curry. When they reach adulthood, they agree to a Marriage of convenience, wherein they will reveal their societies to the world at large together. On the day of their wedding, Hippolyta was killed by a spear thrown by an Atlantean. Unbeknownst to the bride or groom, Hippolyta's death was part of a scheme concocted by Ocean Master, Artemis and Wonder Woman's aunt, Penthesileia, to prevent the union of Aquaman and Wonder Woman (Diana was the intended target, but Hippolyta got in the way). In retaliation, Wonder Woman declares war on Atlantis. Aquaman and the Atlanteans then visit Themyscira to negotiate for peace, but Artemis has bombs dropped on Themyscira, with Wonder Woman angrily believing the Atlanteans were behind it. Wonder Woman's only option is to destroy Themyscira and then escape on the Amazon's invisible planes. She then leads the Amazons in conquering the United Kingdom, renaming it New Themyscira. Wonder Woman later catches Steve Trevor with her Lasso of Truth and begins interrogating him after he is temporarily able to resist the lasso's effects. Steve explains that he was hired to extract Lois Lane from New Themyscira because she was sent to gather information on the Amazons for Cyborg. Wonder Woman states that their counterspy was telling something similar to Cyborg's amassing of superhumans to stop the fighting between her and Aquaman. Her subjects ask her what to do with Steve. Later, Wonder Woman attacks the Resistance member Penny Black, but Penny shows her that people were imprisoned of internment by her aunt Penthesileia. Wonder Woman is furious and frees the people from internment, which she believes that they are not accepted for prison. During this same period, the Amazonian Furies attack the reinforcements of a group of Atlanteans sent to kill Terra, who was being used to keep New Themyscira in the air; Wonder Woman personally joins the battle, confronting the leader, Aquaman. During their struggle, she tells Aquaman that they have both been deceived, when she discovers that her aunt Penthesileia kissing Ocean Master are both responsible for the war between the Atlanteans and the Amazons, that was a ruse planned by them. While the Atlanteans are going to surface, but their attack having been backfired by Ocean Master, Aquaman believes Wonder Woman has set a trap. Wonder Woman escapes from Aquaman, who refuses her word. Wonde"}, "div": "d_set"}];

  let ENCODETITLE = [" ", "%", "!", "#", "$", "&", "'", "(", ")", "*", "+", ",", "/", ":", ";", "=",
    "?", "@", "[", "]"];
  let ENCODEURL = ["_", "%25", "%21", "%23", "%24", "%26", "%27", "%28", "%29",
    "%2A"< "%2B", "%2C", "%2F", "%3A", "%3B", "%3D", "%3F", "%40", "%5B", "%5D"];

  $( window ).init(function(){
    $("body").css("overflow", "hidden");
    $("#container").css("max-width", "2400px");
    $('.row').width($('#container').width());
    let offset = 78 + $('#second-navbar').height();
    $('.row').css('margin-top', offset + 10);
    $('.col').css('height', $( window ).height() - offset - 10);
    $('#content').html("Loading data...");
    loadAllData();
  });

  function loadAllData(){
    $('.textbox').width($('#sidebar').width());
    loadData();
    // $.getJSON("https://github.com/JJumSSu/test/blob/main/all_set_web.json", function(json) {
    //   allData = json;
    //   loadData();
    // });
    /*
    sendAjax("/select", {}, (result) => {
      origData = result;
      allData = result.data;
      loadData();
    });*/
  }
  

  function loadData() {
    $('#sidebar').html('');
    $('#content').html('');
    for (var i=0; i<allData.length; i++) {
      let htmlText = `
      <div id="textbox-` + i + `" class="textbox ` + getClassName(allData[i]) + `">
      ` + allData[i]['claim'] +
      `</div>
      `;
      $('#sidebar').append(htmlText);
    }
    $('.textbox').click(function () {
      $('.textbox-clicked').removeClass('textbox-clicked');
      $('#'+this.id).addClass('textbox-clicked');
      load(parseInt(this.id.substring(8, this.id.length)));
    })
    $('.mode').click(controlDisplay);
    controlDisplay();
  }

  function controlDisplay() {
    let mode = parseInt($('.mode:checked').val());
    ('.textbox-clicked');
    if (mode===0) {
      $('.D_set').show();
      $('.A_set').hide();
      if (getCurrentClassName()==="A_set") {
        $('.textbox-clicked').removeClass('textbox-clicked');
        $('#content').html('');
      }
    } else if (mode===1) {
      $('.D_set').hide();
      $('.A_set').show();
      if (getCurrentClassName()==="D_set") {
        $('.textbox-clicked').removeClass('textbox-clicked');
        $('#content').html('');
      }
    } else {
      $('.D_set').show();
      $('.A_set').show();
    }
   }

  function getClassName(data) {
    //FIXME later
    if (data['div']==="a_set") {
      return "D_set"
    } else {
      return "A_set"
    }
  }

  function getCurrentClassName() {
    let current = $('.textbox-clicked');
    console.assert(current.length<=1);
    if (current.length===1) {
      let currentId = current[0].id;
      return getClassName(allData[parseInt(currentId.substring(8, currentId.length))]);
    }
    return "";
  }

  function load(currentId) {
    $('#content').html("");
    let data = allData[currentId];
    $('#content').append(getPanel("Claim", data["claim"]));
    $('#content').append(getPanel("Label", data["label"]));
  
    htmlText_pos = `
          <p><span class="label label-id">ID</span> ` + data['positive_evidence']['id'] + `</p>
          <p><span class="label label-title">Title</span> ` + data['positive_evidence']['title'] + `</p>
          <p><span class="label label-text">Text</span> ` + data['positive_evidence']['text'] + `</p>
      `;
    $('#content').append(getPanel("Positive Passage", htmlText_pos));
    $('#content').append('<h4>&#8251 Note that the positive passage is not golden, but is the one retrieved from TF-IDF (the top passage that contains the answer to the original question).</h4>');
    
    // htmlText_neg = `
    //       <p><span class="label label-id">ID</span> ` + data['negative_evidence']['id'] + `</p>
    //       <p><span class="label label-title">Title</span> ` + data['negative_evidence']['title'] + `</p>
    //       <p><span class="label label-text">Text</span> ` + data['negative_evidence']['text'] + `</p>
    //   `;
    // $('#content').append(getPanel("Negative Passage", htmlText_neg));

  }

  function getPanel(heading, body) {
    return `<div class="panel panel-default panel-inline">
      <div class="panel-heading">` + heading + `
      </div>
      <div class="panel-body">
      ` + ` ` + body +`</div>
    </div>`;
  }

  function sendAjax(url, data, handle){
    $.getJSON(url, data, function(response){
      handle(response.result);
    });
  }

})();
